# Agent Mode Instructions for Asteroids Game Development

## ğŸ¯ Project Context

You are continuing development of a fully functional Asteroids game built in C++ with Raylib. The core game mechanics are complete and working perfectly. Your role is to add polish features and game systems.

## ğŸ“‹ Current State

### âœ… What's Working (DO NOT BREAK)
- Ship movement, rotation, and physics (WASD + Arrow key controls)
- Bullet shooting with proper physics
- Asteroid spawning, movement, and splitting mechanics
- Collision detection between bullets and asteroids
- Screen wrapping for all objects
- Memory management with proper cleanup
- **COMPLETED PHASE 1**: Score system, Lives system, Game state management, Wave progression system
- **Safe spawn system**: Player-controlled timing for wave transitions and respawns
- **Clean state management**: GameState enum (MENU, WAVE_TRANSITION, WAITING_TO_SPAWN, PLAYING, PAUSED, GAME_OVER)

### ğŸ“ File Structure
```
c:\Projects\Asteroids\
â”œâ”€â”€ .vscode/          # VS Code configuration (configured)
â”œâ”€â”€ src/              # 8-file modular C++ architecture (V1.0+)
â”‚   â”œâ”€â”€ main.cpp      # Main game loop and state management
â”‚   â”œâ”€â”€ physics.cpp   # Ship movement and thrust particles
â”‚   â”œâ”€â”€ game_logic.cpp# Collision detection and game mechanics
â”‚   â”œâ”€â”€ menu_system.cpp# Dynamic unified menu system
â”‚   â”œâ”€â”€ rendering.cpp # HUD, backgrounds, and visual utilities
â”‚   â”œâ”€â”€ audio.cpp     # Procedural sound generation
â”‚   â”œâ”€â”€ particles.cpp # Particle effects system
â”‚   â””â”€â”€ common.h      # Shared data structures and declarations
â”œâ”€â”€ images/           # Screenshot collection
â”œâ”€â”€ Makefile          # Build system (configured)
â”œâ”€â”€ README.md         # Main project documentation
â”œâ”€â”€ CHANGELOG.md      # Version history
â””â”€â”€ roadmap.md        # Local planning file (not in git)
```

### ğŸ—ï¸ Code Architecture Understanding
- **Game Loop**: Clear UPDATE/DRAW separation
- **Structures**: Ship, Bullet, Asteroid with proper encapsulation  
- **Physics**: Momentum-based movement with drag and speed limiting
- **Memory**: std::vector containers with erase/remove_if cleanup
- **Collision**: Circle-based distance calculations
- **Utilities**: RotatePoint function for vector math

## ğŸ¯ Development Approach

### Implementation Rules
1. **Preserve existing functionality** - Never break what's working
2. **Follow existing patterns** - Use established code style and architecture
3. **One feature at a time** - Complete implementations before moving on
4. **Test thoroughly** - Ensure each addition works and doesn't break existing code
5. **Maintain performance** - Keep 60 FPS smooth gameplay

### Code Style Guidelines
- Use existing naming conventions (camelCase for variables, PascalCase for structs)
- Maintain UPDATE/DRAW section separation
- Follow existing vector management patterns
- **ALWAYS fix compiler warnings**: Use `static_cast<int>()` when comparing signed integers with `std::vector::size()` to avoid signedness warnings
- Use proper type casting to eliminate all compiler warnings before completing any implementation
- **CRITICAL HEADER REQUIREMENT**: When using math functions (sin, cos, sinf, cosf, etc.), ALWAYS include `<cmath>` header
- **HEADER MANAGEMENT**: Before using any standard library functions, verify required headers are included:
  - `<cmath>` for mathematical functions (sin, cos, sqrt, fabs, etc.)
  - `<algorithm>` for std algorithms (std::min, std::max, std::clamp, etc.)
  - `<vector>` for std::vector operations
  - `<string>` for std::string operations
  - `<iostream>` for console I/O (debugging only)
- **BUILD VERIFICATION**: After adding any new includes or math functions, immediately build to catch header issues
- Use raylib functions consistently with current usage
- Add features as new code blocks, don't refactor existing working code
- **CRITICAL**: When wrapping existing code in new conditionals, preserve exact indentation
- **CRITICAL**: When making multi-part edits, carefully maintain code structure integrity
- Always use consistent 4-space indentation (match existing pattern)
- When moving code blocks, verify all opening/closing braces align properly
- **DOCUMENTATION**: All functions must have Doxygen-style documentation with @brief, @param, and @return tags
- **PARAMETER CLARITY**: Function documentation must clearly explain parameter purpose, units, and expected ranges

### Large Refactoring Safety Rules
- **AVOID major architectural changes** unless absolutely necessary
- **When refactoring state management**: Make incremental changes, test each step
- **Before large edits**: Read entire affected sections to understand dependencies
- **After structural changes**: Always build immediately to catch syntax errors
- **If compilation fails**: Fix ALL errors before continuing with new features
- **Prefer small, focused changes** over large multi-file refactoring operations
- **When removing variables**: Check ALL references before deletion
- **Document breaking changes** immediately for context

### Priority Order
Follow the roadmap priority order:
1. **Phase 1**: âœ… COMPLETE (Score system, Lives system, Game states, Wave system, Safe spawn)
2. **Phase 2**: Audio â†’ Particles â†’ UI polish  
3. **Phase 3**: Advanced graphics â†’ High scores â†’ Power-ups

## ğŸš€ Specific Implementation Guidelines

### When Adding New Features:
1. **Read existing code** to understand current patterns
2. **Add new structs/variables** after existing declarations
3. **Update logic** in appropriate UPDATE sections
4. **Add rendering** in appropriate DRAW sections
5. **When wrapping existing code**: Make smaller, more careful edits to preserve structure
6. **Verify indentation** matches existing patterns exactly
7. **Test immediately** after implementation

### Key Technical Details:
- **Screen size**: 800x600 pixels
- **Frame rate**: 60 FPS target
- **Physics**: No GetFrameTime() usage (direct pixel movement)
- **Collision radii**: Large(30), Medium(20), Small(10) + bullet(2)
- **Ship rotation**: 3.0f degrees per frame
- **Thrust power**: 0.5f per frame
- **Bullet speed**: 8.0f additional velocity

### Error Prevention:
- Always check `active` flags before processing objects
- Remember to clean up inactive objects with erase/remove_if
- Maintain proper collision detection order (bullets first, then asteroids)
- Screen wrap at exact screen dimensions (0 to screenWidth/screenHeight)
- **HEADER ERRORS**: Before using mathematical functions (sinf, cosf, etc.), verify `<cmath>` is included
- **COMPILATION CHECK**: Test build immediately after adding any new mathematical operations or standard library calls
- **COMMON MISSING HEADERS**: 
  - Math functions â†’ `#include <cmath>`
  - Algorithm functions â†’ `#include <algorithm>` 
  - String operations â†’ `#include <string>`
  - Vector operations â†’ `#include <vector>`

## ğŸ® User Experience Goals

### Maintain Classic Feel
- Preserve authentic Asteroids physics and feel
- Keep controls responsive and smooth
- Maintain challenging but fair gameplay

### Add Modern Polish
- Smooth visual feedback
- Clear UI presentation
- Intuitive state transitions
- Satisfying audio feedback

## ğŸ” Testing Requirements

After each feature implementation:
- [ ] **HEADERS CHECK**: All required headers included (especially `<cmath>` for math functions)
- [ ] Game compiles and runs **without errors OR warnings**
- [ ] New feature functions as designed
- [ ] All existing mechanics still work correctly
- [ ] No performance degradation
- [ ] No memory leaks or crashes
- [ ] Visual presentation is clean and readable

## ğŸ“ Documentation Expectations

For each feature added:
1. **Comment major additions** in code
2. **Update README.md** with new features and changes
3. **Update CHANGELOG.md** with version entries and detailed changes
4. **Note any architectural changes** in commit messages
5. **Record any challenges/solutions** for future reference

### Primary Documentation Files
- **README.md** - Main project documentation, features, screenshots, build instructions
- **CHANGELOG.md** - Version history and detailed change tracking
- **Note**: roadmap.md is kept locally only (not tracked in git)

---
*Goal: Transform the complete core game into a polished, feature-rich Asteroids experience*